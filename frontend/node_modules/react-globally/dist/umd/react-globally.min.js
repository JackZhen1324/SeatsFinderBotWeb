!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e(t.ReactGlobally={},t.React)}(this,function(t,e){"use strict";function n(t){return function(){return t}}var r="default"in e?e.default:e,o=function(){};o.thatReturns=n,o.thatReturnsFalse=n(!1),o.thatReturnsTrue=n(!0),o.thatReturnsNull=n(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(t){return t};var a=o,i=function(t,e,n,r,o,a,i,l){if(!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,o,a,i,l],s=0;(c=new Error(e.replace(/%s/g,function(){return u[s++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},l="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",c=function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t){t.exports=function(){function t(t,e,n,r,o,a){a!==l&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return n.checkPropTypes=a,n.PropTypes=n,n}()}),u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},f=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},b=function t(e){var n=this;u(this,t),this.getState=function(){return n.currentState},this.setState=function(t){n.currentState=t,n.listners.forEach(function(t){return t(n.currentState)})},this.subscribe=function(t){n.listners.push(t)},this.unsubscribe=function(t){n.listners=n.listners.filter(function(e){return e!==t})},this.currentState=e,this.listners=[]},y=function(t){function e(){var t,n,r,o;u(this,e);for(var a=arguments.length,i=Array(a),l=0;l<a;l++)i[l]=arguments[l];return n=r=h(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(i))),r.globalState=new b(r.props.globalState),o=n,h(r,o)}return f(e,t),s(e,[{key:"getChildContext",value:function(){return{globalState:this.globalState,createSetGlobalState:this.props.createSetGlobalState}}},{key:"componentWillReceiveProps",value:function(t){this.globalState.setState(t.globalState)}},{key:"render",value:function(){return this.props.children}}]),e}(e.Component);y.displayName="GlobalStateBroadcast",y.propTypes={globalState:c.object.isRequired,createSetGlobalState:c.func.isRequired},y.childContextTypes={globalState:c.object.isRequired,createSetGlobalState:c.func.isRequired};var S=function(t){function e(){var t,n,r,o;u(this,e);for(var a=arguments.length,i=Array(a),l=0;l<a;l++)i[l]=arguments[l];return n=r=h(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(i))),r.state=r.props.globalState,r.createSetGlobalState=function(t){return function(e,n){e&&e.constructor&&e.call&&e.apply?r.setState(function(n){return e(n,t)},function(){n&&n()}):r.setState(e,function(){n&&n()})}},o=n,h(r,o)}return f(e,t),s(e,[{key:"render",value:function(){return r.createElement(y,{globalState:this.state,createSetGlobalState:this.createSetGlobalState},this.props.children)}}]),e}(e.Component);S.propTypes={globalState:c.object.isRequired};t.Provider=S,t.withGlobalState=function(t){var n=function(e){function n(){var t,e,r,o;u(this,n);for(var a=arguments.length,i=Array(a),l=0;l<a;l++)i[l]=arguments[l];return e=r=h(this,(t=n.__proto__||Object.getPrototypeOf(n)).call.apply(t,[this].concat(i))),r.state=null,r.syncStateWithGlobalState=function(t){r.setState(t)},o=e,h(r,o)}return f(n,e),s(n,[{key:"componentWillMount",value:function(){this.setState(this.context.globalState.getState())}},{key:"componentDidMount",value:function(){this.context.globalState.subscribe(this.syncStateWithGlobalState)}},{key:"componentWillUnmount",value:function(){this.context.globalState.unsubscribe(this.syncStateWithGlobalState)}},{key:"render",value:function(){return r.createElement(t,p({},this.props,{globalState:this.state,setGlobalState:this.context.createSetGlobalState(this.props)}))}}]),n}(e.Component);return n.displayName="WithGlobalState("+(t.displayName||t.name||"Component")+")",n.contextTypes={globalState:c.object.isRequired,createSetGlobalState:c.func.isRequired},n},Object.defineProperty(t,"__esModule",{value:!0})});
